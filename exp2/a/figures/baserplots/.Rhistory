thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
y
summary(h1.h3_main_m2)
pdf('hypotheses_all.pdf',width = 6, height=12)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 10, height=10)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 10, height=6)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 12, height=6)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 11, height=6)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='H1. Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'),
main = 'H2. Demand is held constant')
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='H3. Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 11, height=4)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='H1. Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'),
main = 'H2. Demand is held constant')
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='H3. Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
pdf('hypotheses_all.pdf',width = 11, height=4)
layout(matrix(c(1, 2, 3), 1, 3))
h1 <- fit_data[fit_data$prog_type %in% c('11', '00') & !is.na(fit_data$effchoice), ]
y  <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), mean)
se <- tapply(h1$effchoice, list(as.character(h1$effort_type), h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='H1. Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, as.character(h2$effort_type), mean)
se <- tapply(h2$progchoice, as.character(h2$effort_type), myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'),
main = 'H2. Demand is held constant')
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
h3 <- fit_data[fit_data$prog_type %in% c('01', '10') & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), mean)
se  <- tapply(h3$effchoice, list(h3$prog_type, as.character(h3$effort_type)), myse)
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose High Demand)',
ylim = range(pretty(c(y-se, (y+se)+.1))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='H3. Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
setwd("~/Desktop/Ongoing/EffortProg/Exp2/a/analysis/figures/full/baserplots")
rm(list=ls())
load('~/Desktop/Ongoing/EffortProg/Exp2/a/analysis/full/effprog2.RData')
myse <- function(x) sd(x, na.rm=T)/sqrt(length(x))
pdf('hypotheses.pdf')
# h1
h1 <- fit_data[fit_data$prog_type %in% c('11', '00'), ]
y  <- tapply(h1$effchoice, list(h1$effort_type, h1$prog_type), mean)
se <- tapply(h1$effchoice, list(h1$effort_type, h1$prog_type), myse)
thisbar <-
barplot(y,
beside=T,
xlab = '',
ylab = 'p(Choose High Demand)',
ylim = c(0,1),
xpd = F,
names.arg = c('neither deck yields progress', 'both decks yield progress'),
main='Progress is held constant',
legend.text = T,
args.legend = list(title='Demand Pairs',
legend=c('10%-50%',
'10%-90%',
'50%-90%'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
# h2
# a.
layout(matrix(c(1, 2), 1, 2))
h2 <- fit_data[fit_data$effort_type %in% c('11', '22', '33'), ]
y  <- tapply(h2$progchoice, h2$effort_type, mean)
se <- tapply(h2$progchoice, h2$effort_type, myse)
thisbar <-
barplot(y,
xlab = 'Demand Pairing',
ylab = 'p(Choose Progress)',
ylim = c(0,1),
xpd = F,
names.arg = c('10%-10%', '50%-50%', '90%-90%'))
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
# b.
subprog = tapply(h2$progchoice, h2$id, mean, na.rm=T)
hist(subprog,
xlab = 'p(Choose Progress)',
ylab = 'Number of subjects',
xlim =c(0, 1),
main='')
abline(v=0.45, lty='dashed', lwd=3)
mtext('Demand is held constant', line=-2, outer=T, font=2, cex = 1)
# h3
layout(matrix(1))
h3 <- fit_data[fit_data$prog_type == '01' & !is.na(fit_data$effchoice), ]
y  <- tapply(h3$effchoice, h3$effort_type, mean)
y <- matrix(y[c(1, 3, 2, 5, 4, 6)], 2, 3,
dimnames = list(c('01', '10'), c('10%-50%', '10%-90%', '50%-90%')))
se  <- tapply(h3$effchoice, h3$effort_type, myse)
se  <- matrix(se[c(1, 3, 2, 5, 4, 6)], 2, 3,
dimnames = list(c('01', '10'), c('10%-50%', '10%-90%', '50%-90%')))
thisbar <-
barplot(y,
beside=T,
xlab = 'Demand Pairing',
ylab = 'p(Choose High Demand)',
ylim = range(pretty(c(y-se, y+se))),
xpd = F,
names.arg = c('10%-50%', '10%-90%', '50%-90%'),
main='Demand and progress vary',
legend.text = T,
col = c('#1e2625', '#828c84'),
args.legend = list(legend = c('High demand yields progress', 'Low demand yields progress'))
)
arrows(thisbar, y-se, thisbar, y+se, code=3, angle=90, length=0.1)
abline(h=0.5, lty = 'dashed')
dev.off()
curve(dnorm(x, 13, sqrt(16)))
dev.off()
curve(dnorm(x, 13, sqrt(16)))
x
dev.off()
z
curve(dnorm(z, 13, sqrt(16)))
curve(dnorm(z, 13, sqrt(16)), seq(0, 100))
?curve
curve(dnorm(x, 13, 4), 8, 20)
curve(dnorm(x, 13, 4), 6, 20)
curve(dnorm(x, 13, 4), 6, 20, xlab='Number of trials', ylab='Density')
range(d$subtrial)
curve(pnorm(x, 13, 4), 6, 20, xlab='Number of trials', ylab='Density')
curve(dnorm(x, 13, 4), 6, 20, xlab='Number of trials', ylab='Density')
length(unique(d$id))
load('~/Desktop/Ongoing/EffortProg/Exp2/a/analysis/full/effprog2.RData')
rm(list=ls())
load('~/Desktop/Ongoing/EffortProg/Exp2/a/analysis/full/effprog2.RData')
ls()
# * * H1 AND H3 ####
# most complex causes convergence: try different optimizers, use best one
# af = allFit(h1.h3_main_m3)
h1.h3_main_m0 <- glmer(effchoice ~ 1 + (1|id), data=fit_data, family = 'binomial')
h1.h3_main_m1 <- glmer(effchoice ~ 0 + effort_type + (1|id), data=fit_data, family = 'binomial')
#h1.h3_main_m2 <- glmer(effchoice ~ 0 + effort_type+prog_type + (1|id), data=fit_data, family = 'binomial')
h1.h3_main_m2 <- glmer(effchoice ~ 0 + effort_type:prog_type + (1|id), data=fit_data, family = 'binomial', glmerControl(optimizer = 'bobyqa'))
anova(h1.h3_main_m0, h1.h3_main_m1)
anova(h1.h3_main_m0, h1.h3_main_m2)
# * * H2 ####
h2_main_m0 <- glmer(progchoice ~ 1 + (1|id), family = 'binomial', data=fit_data[is.na(fit_data$effchoice), ])
h2_main_m1 <- glmer(progchoice ~ 0+effort_type + (1|id), family = 'binomial', data=fit_data[is.na(fit_data$effchoice), ])
summary(h1.h3_main_m2)
